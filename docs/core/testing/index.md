---
title: .NET Core 中的单元测试
description: 单元测试从未如此简单。 了解如何在 .NET Core 和 .NET Standard 项目中使用单元测试。
author: ardalis
ms.author: wiwagn
ms.date: 08/30/2017
ms.openlocfilehash: 5b54e7936fb19a94fad9585c00904ae67a59e064
ms.sourcegitcommit: d88024e6d6d8b242feae5f4007a709379355aa24
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 10/13/2018
ms.locfileid: "49314845"
---
# <a name="unit-testing-in-net-core-and-net-standard"></a><span data-ttu-id="cb38e-104">.NET Core 和 .NET Standard 中的单元测试</span><span class="sxs-lookup"><span data-stu-id="cb38e-104">Unit testing in .NET Core and .NET Standard</span></span>

<span data-ttu-id="cb38e-105">由于在设计 .NET Core 时考虑到了可测试性，因此为应用程序创建单元测试比以往更加简单。</span><span class="sxs-lookup"><span data-stu-id="cb38e-105">.NET Core has been designed with testability in mind, so that creating unit tests for your applications is easier than ever before.</span></span> <span data-ttu-id="cb38e-106">本文简要介绍了单元测试（以及与其他类型测试的不同之处）。</span><span class="sxs-lookup"><span data-stu-id="cb38e-106">This article briefly introduces unit tests (and how they differ from other kinds of tests).</span></span> <span data-ttu-id="cb38e-107">链接的资源展示了如何将测试项目添加到解决方案中，再使用命令行或 Visual Studio 运行单元测试。</span><span class="sxs-lookup"><span data-stu-id="cb38e-107">Linked resources demonstrate how to add a test project to your solution and then run unit tests using either the command line or Visual Studio.</span></span>

<span data-ttu-id="cb38e-108">.NET Core 2.0 支持 [.NET Standard 2.0](../../standard/net-standard.md)。</span><span class="sxs-lookup"><span data-stu-id="cb38e-108">.NET Core 2.0 supports [.NET Standard 2.0](../../standard/net-standard.md).</span></span> <span data-ttu-id="cb38e-109">本部分中用于演示单元测试的库依赖 .NET Standard，同时也适用于其他项目类型。</span><span class="sxs-lookup"><span data-stu-id="cb38e-109">The libraries used to demonstrate unit testing in this section rely on .NET Standard and will work in other project types as well.</span></span>

<span data-ttu-id="cb38e-110">自 .NET Core 2.0 起，提供适用于 C#、F# 和 Visual Basic 的单元测试项目模板。</span><span class="sxs-lookup"><span data-stu-id="cb38e-110">Beginning with .NET Core 2.0, there are unit test project templates for C#, F# and Visual Basic.</span></span>

## <a name="getting-started-with-testing"></a><span data-ttu-id="cb38e-111">测试入门</span><span class="sxs-lookup"><span data-stu-id="cb38e-111">Getting started with testing</span></span>

<span data-ttu-id="cb38e-112">确保软件应用程序按作者的期望执行操作，其中最好的一种方法是拥有自动化测试套件。</span><span class="sxs-lookup"><span data-stu-id="cb38e-112">Having a suite of automated tests is one of the best ways to ensure a software application does what its authors intended it to do.</span></span> <span data-ttu-id="cb38e-113">可以对软件应用程序进行各种不同的测试，包括集成测试、Web 测试、负载测试等。</span><span class="sxs-lookup"><span data-stu-id="cb38e-113">There are different kinds of tests for software applications, including integration tests, web tests, load tests, and others.</span></span> <span data-ttu-id="cb38e-114">测试各个软件组件或方法的单元测试是最低级测试。</span><span class="sxs-lookup"><span data-stu-id="cb38e-114">Unit tests that test individual software components or methods are the lowest level tests.</span></span> <span data-ttu-id="cb38e-115">单元测试只应测试开发人员控件中的代码，而不应测试基础结构问题，如数据库、文件系统或网络资源等。</span><span class="sxs-lookup"><span data-stu-id="cb38e-115">Unit tests should only test code within the developer’s control, and should not test infrastructure concerns, like databases, file systems, or network resources.</span></span> <span data-ttu-id="cb38e-116">可以使用[测试驱动开发 (TDD)](https://deviq.com/test-driven-development/) 编写单元测试，或将其添加到现有代码以确认其正确性。</span><span class="sxs-lookup"><span data-stu-id="cb38e-116">Unit tests may be written using [Test Driven Development (TDD)](https://deviq.com/test-driven-development/), or they can be added to existing code to confirm its correctness.</span></span> <span data-ttu-id="cb38e-117">无论属于上述哪种情况，单元测试都应该是命名恰当且运行速度快的小型测试，因为理想情况下，都希望能够先运行数百个单元测试，再将更改推送到项目的共享代码存储库中。</span><span class="sxs-lookup"><span data-stu-id="cb38e-117">In either case, they should be small, well-named, and fast, since ideally you want to be able to run hundreds of them before pushing your changes into the project’s shared code repository.</span></span>

> [!NOTE]
> <span data-ttu-id="cb38e-118">开发人员经常要想方设法地为测试类和方法提供合适的名称。</span><span class="sxs-lookup"><span data-stu-id="cb38e-118">Developers often struggle with coming up with good names for their test classes and methods.</span></span> <span data-ttu-id="cb38e-119">作为起点，ASP.NET 产品团队会遵循[这些约定](https://github.com/aspnet/Home/wiki/Engineering-guidelines#unit-tests-and-functional-tests)。</span><span class="sxs-lookup"><span data-stu-id="cb38e-119">As a starting point, the ASP.NET product team follows [these conventions](https://github.com/aspnet/Home/wiki/Engineering-guidelines#unit-tests-and-functional-tests).</span></span>

<span data-ttu-id="cb38e-120">编写单元测试时，注意不要在基础结构上意外引入了依赖项。</span><span class="sxs-lookup"><span data-stu-id="cb38e-120">When writing unit tests, be careful you don’t accidentally introduce dependencies on infrastructure.</span></span> <span data-ttu-id="cb38e-121">这些依赖项往往会降低测试速度，使测试更加脆弱，因此应将其保留供集成测试使用。</span><span class="sxs-lookup"><span data-stu-id="cb38e-121">These tend to make tests slower and more brittle, and thus should be reserved for integration tests.</span></span> <span data-ttu-id="cb38e-122">可以通过遵循 [Explicit Dependencies Principle](https://deviq.com/explicit-dependencies-principle/)（显示依赖项原则）和使用 [Dependency Injection](/aspnet/core/fundamentals/dependency-injection)（依赖项注入）从框架中请求依赖项，以此避免应用程序代码中的这些隐藏依赖项。</span><span class="sxs-lookup"><span data-stu-id="cb38e-122">You can avoid these hidden dependencies in your application code by following the [Explicit Dependencies Principle](https://deviq.com/explicit-dependencies-principle/) and using [Dependency Injection](/aspnet/core/fundamentals/dependency-injection) to request your dependencies from the framework.</span></span> <span data-ttu-id="cb38e-123">还可以将单元测试保留在单独的项目中，与集成测试相分隔，并确保单元测试项目没有引用或依赖于基础结构包。</span><span class="sxs-lookup"><span data-stu-id="cb38e-123">You can also keep your unit tests in a separate project from your integration tests and ensure your unit test project doesn’t have references to or dependencies on infrastructure packages.</span></span>

<span data-ttu-id="cb38e-124">了解有关 .NET Core 项目中的单元测试的详细信息：</span><span class="sxs-lookup"><span data-stu-id="cb38e-124">Learn more about unit testing in .NET Core projects:</span></span>

<span data-ttu-id="cb38e-125">支持对 .NET Core 单元测试项目使用 [C#](../../csharp/index.md)、[F#](../../fsharp/index.md) 和 [Visual Basic](../../visual-basic/index.md)。</span><span class="sxs-lookup"><span data-stu-id="cb38e-125">Unit test projects for .NET Core are supported for [C#](../../csharp/index.md), [F#](../../fsharp/index.md) and [Visual Basic](../../visual-basic/index.md).</span></span> <span data-ttu-id="cb38e-126">还可以在 [xUnit](https://xunit.github.io)、[NUnit](https://nunit.org) 与 [MSTest](https://github.com/Microsoft/vstest-docs) 之间进行选择。</span><span class="sxs-lookup"><span data-stu-id="cb38e-126">You can also choose between [xUnit](https://xunit.github.io), [NUnit](https://nunit.org) and [MSTest](https://github.com/Microsoft/vstest-docs).</span></span>

<span data-ttu-id="cb38e-127">下面的演练介绍了这些组合使用方式：</span><span class="sxs-lookup"><span data-stu-id="cb38e-127">You can read about those combinations in these walkthroughs:</span></span>

* <span data-ttu-id="cb38e-128">[结合使用 .NET Core CLI 与 xUnit 和 C#](unit-testing-with-dotnet-test.md) 创建单元测试。</span><span class="sxs-lookup"><span data-stu-id="cb38e-128">Create unit tests using [*xUnit* and *C#* with the .NET Core CLI](unit-testing-with-dotnet-test.md).</span></span>
* <span data-ttu-id="cb38e-129">[结合使用 .NET Core CLI 与 NUnit 和 C#](unit-testing-with-nunit.md) 创建单元测试。</span><span class="sxs-lookup"><span data-stu-id="cb38e-129">Create unit tests using [*NUnit* and *C#* with the .NET Core CLI](unit-testing-with-nunit.md).</span></span>
* <span data-ttu-id="cb38e-130">[结合使用 .NET Core CLI 与 MSTest 和 C#](unit-testing-with-mstest.md) 创建单元测试。</span><span class="sxs-lookup"><span data-stu-id="cb38e-130">Create unit tests using [*MSTest* and *C#* with the .NET Core CLI](unit-testing-with-mstest.md).</span></span>
* <span data-ttu-id="cb38e-131">[结合使用 .NET Core CLI 与 xUnit 和 F#](unit-testing-fsharp-with-dotnet-test.md) 创建单元测试。</span><span class="sxs-lookup"><span data-stu-id="cb38e-131">Create unit tests using [*xUnit* and *F#* with the .NET Core CLI](unit-testing-fsharp-with-dotnet-test.md).</span></span>
* <span data-ttu-id="cb38e-132">[结合使用 .NET Core CLI 与 NUnit 和 F#](unit-testing-fsharp-with-nunit.md) 创建单元测试。</span><span class="sxs-lookup"><span data-stu-id="cb38e-132">Create unit tests using [*NUnit* and *F#* with the .NET Core CLI](unit-testing-fsharp-with-nunit.md).</span></span>
* <span data-ttu-id="cb38e-133">[结合使用 .NET Core CLI 与 MSTest 和 F#](unit-testing-fsharp-with-mstest.md) 创建单元测试。</span><span class="sxs-lookup"><span data-stu-id="cb38e-133">Create unit tests using [*MSTest* and *F#* with the .NET Core CLI](unit-testing-fsharp-with-mstest.md).</span></span>
* <span data-ttu-id="cb38e-134">[结合使用 .NET Core CLI 与 xUnit 和 Visual Basic](unit-testing-visual-basic-with-dotnet-test.md) 创建单元测试。</span><span class="sxs-lookup"><span data-stu-id="cb38e-134">Create unit tests using [*xUnit* and *Visual Basic* with the .NET Core CLI](unit-testing-visual-basic-with-dotnet-test.md).</span></span>
* <span data-ttu-id="cb38e-135">[结合使用 .NET Core CLI 与 NUnit 和 Visual Basic](unit-testing-visual-basic-with-nunit.md) 创建单元测试。</span><span class="sxs-lookup"><span data-stu-id="cb38e-135">Create unit tests using [*NUnit* and *Visual Basic* with the .NET Core CLI](unit-testing-visual-basic-with-nunit.md).</span></span>
* <span data-ttu-id="cb38e-136">[结合使用 .NET Core CLI 与 MSTest 和 Visual Basic](unit-testing-visual-basic-with-mstest.md) 创建单元测试。</span><span class="sxs-lookup"><span data-stu-id="cb38e-136">Create unit tests using [*MSTest* and *Visual Basic* with the .NET Core CLI](unit-testing-visual-basic-with-mstest.md).</span></span>

<span data-ttu-id="cb38e-137">可以选择不同的语言用于类库和单元测试库。</span><span class="sxs-lookup"><span data-stu-id="cb38e-137">You can choose different languages for your class libraries and your unit test libraries.</span></span> <span data-ttu-id="cb38e-138">通过混合搭配参考上面引用的演练，可以了解具体操作方法。</span><span class="sxs-lookup"><span data-stu-id="cb38e-138">You can learn how by mixing and matching the walkthroughs referenced above.</span></span>

* <span data-ttu-id="cb38e-139">Visual Studio Enterprise 提供用于 .NET Core 的卓越测试工具。</span><span class="sxs-lookup"><span data-stu-id="cb38e-139">Visual Studio Enterprise offers great testing tools for .NET Core.</span></span> <span data-ttu-id="cb38e-140">有关详细信息，请查看 [Live Unit Testing](/visualstudio/test/live-unit-testing) 或[代码覆盖率](https://github.com/Microsoft/vstest-docs/blob/master/docs/analyze.md#working-with-code-coverage)。</span><span class="sxs-lookup"><span data-stu-id="cb38e-140">Check out [Live Unit Testing](/visualstudio/test/live-unit-testing) or [code coverage](https://github.com/Microsoft/vstest-docs/blob/master/docs/analyze.md#working-with-code-coverage) to learn more.</span></span>
* <span data-ttu-id="cb38e-141">有关如何使用选择性单元测试筛选的其他信息和示例，请参阅[运行选择性单元测试](selective-unit-tests.md)或[使用 Visual Studio 添加和排除测试](/visualstudio/test/live-unit-testing#include-and-exclude-test-projects-and-test-methods)。</span><span class="sxs-lookup"><span data-stu-id="cb38e-141">For additional information and examples on how to use selective unit test filtering, see [Running selective unit tests](selective-unit-tests.md), or [including and excluding tests with Visual Studio](/visualstudio/test/live-unit-testing#include-and-exclude-test-projects-and-test-methods).</span></span>
* <span data-ttu-id="cb38e-142">XUnit 团队编写了一个教程，介绍[如何通过 .NET Core 和 Visual Studio 使用 xUnit](https://xunit.github.io/docs/getting-started-dotnet-core.html)。</span><span class="sxs-lookup"><span data-stu-id="cb38e-142">The xUnit team has written a tutorial that shows [how to use xUnit with .NET Core and Visual Studio](https://xunit.github.io/docs/getting-started-dotnet-core.html).</span></span>
